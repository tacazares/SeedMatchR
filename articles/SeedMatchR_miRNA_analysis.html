<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Exploring perturbation of miRNA pathways by siRNA knockdown using SeedMatchR • SeedMatchR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Exploring perturbation of miRNA pathways by siRNA knockdown using SeedMatchR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SeedMatchR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/SeedMatchR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/SeedMatchR_Annotation_Databases.html">Overview of SeedMatchR Annotation Databases</a></li>
    <li><a class="dropdown-item" href="../articles/SeedMatchR_build_PPI_network.html">SeedmatchR build PPI networks</a></li>
    <li><a class="dropdown-item" href="../articles/SeedMatchR_ECDF_statistics.html">SeedMatchR ECDF Statistics</a></li>
    <li><a class="dropdown-item" href="../articles/SeedMatchR_miRNA_analysis.html">Exploring perturbation of miRNA pathways by siRNA knockdown using SeedMatchR</a></li>
    <li><a class="dropdown-item" href="../articles/SeedMatchR_noncanonical_searches.html">SeedMatchR_noncanonical_searches</a></li>
    <li><a class="dropdown-item" href="../articles/SeedMatchR_OutputFormats.html">SeedMatchR output formats</a></li>
    <li><a class="dropdown-item" href="../articles/SeedMatchR_search_details.html">SeedMatchR Search Details</a></li>
    <li><a class="dropdown-item" href="../articles/SeedMatchR_sequence_kmer_counts.html">Transcript library k-mer counts with Biostrings</a></li>
    <li><a class="dropdown-item" href="../articles/SeedMatchReport.html">Generate a SeedMatchReport for select sequence definitions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Exploring perturbation of miRNA pathways by siRNA knockdown using SeedMatchR</h1>
                        <h4 data-toc-skip class="author">Tareian
Cazares</h4>
            
      

      <div class="d-none name"><code>SeedMatchR_miRNA_analysis.Rmd</code></div>
    </div>

    
    
<p>In this example we will use a few <code>SeedMatchR</code> functions
to examine changes in expression profiles of miRNA target genes. We will
use miRDB as our source of miRNA targets.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of SeedMatchR from <a href="https://github.com/" class="external-link">GitHub</a> or the stable build from CRAN.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">SeedMatchR</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-example-data">Load example data<a class="anchor" aria-label="anchor" href="#load-example-data"></a>
</h2>
<p>This example uses the siRNA sequence, D1, targeting the Ttr gene in
rat liver from the publication:</p>
<pre><code>Schlegel MK, Janas MM, Jiang Y, Barry JD, Davis W, Agarwal S, Berman D, Brown CR, Castoreno A, LeBlanc S, Liebow A, Mayo T, Milstein S, Nguyen T, Shulga-Morskaya S, Hyde S, Schofield S, Szeto J, Woods LB, Yilmaz VO, Manoharan M, Egli M, Charissé K, Sepp-Lorenzino L, Haslett P, Fitzgerald K, Jadhav V, Maier MA. From bench to bedside: Improving the clinical safety of GalNAc-siRNA conjugates using seed-pairing destabilization. Nucleic Acids Res. 2022 Jul 8;50(12):6656-6670. doi: 10.1093/nar/gkac539. PMID: 35736224; PMCID: PMC9262600.</code></pre>
<p>The guide sequence of interest is 23 bp long and oriented 5’ -&gt;
3’.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># siRNA sequence of interest targeting a 23 bp region of the Ttr gene</span></span>
<span><span class="va">guide.seq</span> <span class="op">=</span> <span class="st">"UUAUAGAGCAAGAACACUGUUUU"</span></span></code></pre></div>
<div class="section level4">
<h4 id="download-data-only-need-to-perform-once-can-skip-to-loading-if-done">Download data (only need to perform once, can skip to loading if
done)<a class="anchor" aria-label="anchor" href="#download-data-only-need-to-perform-once-can-skip-to-loading-if-done"></a>
</h4>
<p>We start by downloading the example data set. This function will
download three files from the GEO accession <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE184929" class="external-link">GSE184929</a>.
These files represent three samples with different siRNA treatments at
two dosages.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_example_data.html">get_example_data</a></span><span class="op">(</span><span class="st">"sirna"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="load-example-data-1">Load example data<a class="anchor" aria-label="anchor" href="#load-example-data-1"></a>
</h4>
<p>We can load the example data into the environment.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sirna.data</span> <span class="op">=</span> <span class="fu"><a href="../reference/load_example_data.html">load_example_data</a></span><span class="op">(</span><span class="st">"sirna"</span><span class="op">)</span></span></code></pre></div>
<p>The DESeq2 results are available through the names
<code>Schlegel_2022_Ttr_D1_30mkg</code>,
<code>Schlegel_2022_Ttr_D4_30mkg</code> and
<code>Schlegel_2022_Ttr_D1_10mkg</code>. The data set name is long, so
it will be renamed to <code>res</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="va">sirna.data</span><span class="op">$</span><span class="va">Schlegel_2022_Ttr_D1_10mkg</span></span>
<span></span>
<span><span class="co"># Filter DESeq2 results for SeedMatchR</span></span>
<span><span class="va">res</span> <span class="op">=</span> <span class="fu">filter_deseq</span><span class="op">(</span><span class="va">res</span>, fdr.cutoff<span class="op">=</span><span class="fl">1</span>, fc.cutoff<span class="op">=</span><span class="fl">0</span>, rm.na.log2fc <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="load-annotations">Load Annotations<a class="anchor" aria-label="anchor" href="#load-annotations"></a>
</h2>
<p>We will next load the annotations for rat. This step is further
described in the vignette.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the species specific annotation database object</span></span>
<span><span class="va">anno.db</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_species_anno_db.html">load_species_anno_db</a></span><span class="op">(</span><span class="st">"rat"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the specific features and sequences of interest</span></span>
<span><span class="va">features</span> <span class="op">=</span> <span class="fu">get_feature_seqs</span><span class="op">(</span><span class="va">anno.db</span><span class="op">$</span><span class="va">tx.db</span>, <span class="va">anno.db</span><span class="op">$</span><span class="va">dna</span>, feature.type <span class="op">=</span> <span class="st">"3UTR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="search-features-for-seed-matches">Search features for seed matches<a class="anchor" aria-label="anchor" href="#search-features-for-seed-matches"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/SeedMatchR.html">SeedMatchR</a></span><span class="op">(</span><span class="va">res</span>, <span class="va">anno.db</span><span class="op">$</span><span class="va">gtf</span>, <span class="va">features</span><span class="op">$</span><span class="va">seqs</span>, <span class="va">guide.seq</span>, <span class="st">"mer7m8"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="preparing-mirdb-for-use-with-seedmatchr">Preparing miRDB for use with SeedMatchR<a class="anchor" aria-label="anchor" href="#preparing-mirdb-for-use-with-seedmatchr"></a>
</h2>
<p>The <code>miRDB</code> database is used to identify mRNA that are
predicted to be targets of miRNA. We download the latest version of
miRDB from the website and modify the data to include information for
gene symbol, ENTREZ ID, and ENSEMBL ID. We use the
<code>org.Rn.eg.db</code> data package to access species specific
annotation information for ENSEMBL.</p>
<div class="section level3">
<h3 id="download-mirdb-only-needs-to-be-performed-once-can-skip-to-loading-if-done">Download miRDB (only needs to be performed once, can skip to loading
if done)<a class="anchor" aria-label="anchor" href="#download-mirdb-only-needs-to-be-performed-once-can-skip-to-loading-if-done"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_example_data.html">get_example_data</a></span><span class="op">(</span><span class="st">"mirna"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-mirdb-into-the-environment">Load miRDB into the environment<a class="anchor" aria-label="anchor" href="#load-mirdb-into-the-environment"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mirdb</span> <span class="op">=</span> <span class="fu"><a href="../reference/load_example_data.html">load_example_data</a></span><span class="op">(</span><span class="st">"mirna"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mirdb.rat</span> <span class="op">=</span> <span class="va">mirdb</span><span class="op">[</span><span class="va">mirdb</span><span class="op">$</span><span class="va">species</span> <span class="op">==</span> <span class="st">"rno"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mirdb.rat</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="map-ensembl-names">Map ENSEMBL names<a class="anchor" aria-label="anchor" href="#map-ensembl-names"></a>
</h3>
<p>Since the names of the target genes are in REFSEQ format, we will use
the R package <code>org.Rn.eg.db</code> to help map REFSEQ IDs to
ENSEMBL IDs.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">org.Rn.eg.db</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create the annotation database based on refseq, ensembl, and gene symbol annotations</span></span>
<span><span class="va">mir.targets</span> <span class="op">=</span> <span class="fu">AnnotationDbi</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/AnnotationDb-class.html" class="external-link">select</a></span><span class="op">(</span><span class="va">org.Rn.eg.db</span>,</span>
<span>                                      keys <span class="op">=</span> <span class="va">mirdb.rat</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>                                      keytype <span class="op">=</span><span class="st">"REFSEQ"</span>,</span>
<span>                                      columns<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ENSEMBL"</span>, <span class="st">"SYMBOL"</span>, <span class="st">"ENTREZID"</span><span class="op">)</span>,</span>
<span>                                      multiVals<span class="op">=</span><span class="st">"list"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Find the IDs as as ENSEMBL IDs and return as a list</span></span>
<span><span class="va">mir.targ.ens</span> <span class="op">&lt;-</span> <span class="va">mir.targets</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">REFSEQ</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>ENSEMBL_ID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/toString.html" class="external-link">toString</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">ENSEMBL</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Match the IDs for ENSEMBL</span></span>
<span><span class="va">ref2ens</span> <span class="op">&lt;-</span> <span class="va">mir.targ.ens</span><span class="op">$</span><span class="va">ENSEMBL_ID</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">mirdb.rat</span><span class="op">$</span><span class="va">target.REFSEQ.ID</span>,</span>
<span>                                           <span class="va">mir.targ.ens</span><span class="op">$</span><span class="va">REFSEQ</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Bind the new columns</span></span>
<span><span class="va">mirdb.rat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mirdb.rat</span>, <span class="va">ref2ens</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="finding-mirna-target-genes-based-on-mirna-expression-data">Finding miRNA target genes based on miRNA expression data<a class="anchor" aria-label="anchor" href="#finding-mirna-target-genes-based-on-mirna-expression-data"></a>
</h2>
<p>If you have smallRNAseq expression data, you can use it to decide
which miRNA are potentially expressed in your system. If not, you can
follow the below approach to identify public small RNAseq experiments
and generate a list of top expressed microRNA.</p>
<div class="section level3">
<h3 id="public-rat-liver-small-rna-expression-data">Public rat liver small RNA expression data<a class="anchor" aria-label="anchor" href="#public-rat-liver-small-rna-expression-data"></a>
</h3>
<p>Here is an example of looking at miRNA expression data from 6 week
old female rat liver in baseline conditions. This data was collected
from the GEO accession <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE172269" class="external-link">GSE172269</a>.
There are four replicates GSM5251324, GSM5251325, GSM5251326,
GSM5251327.</p>
<p>In this case, we work with the normalized counts data. We take the
average across all replicates in the group to find the average miRNA
expression. Then we sort the list by highest expressed miRNA. You can
then choose a cutoff based off of expression, rank, or some combination
of the two. This data is provided as a data object called
<code>GSE172269_F_Lvr_6wks_miRNA</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">top_10</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rno-miR-192-5p"</span>, <span class="st">"rno-miR-22-3p"</span>, <span class="st">"rno-miR-148a-3p"</span>, <span class="st">"rno-miR-10a-5p"</span>, <span class="st">"rno-miR-26a-5p"</span>, <span class="st">"rno-miR-21-5p"</span>, <span class="st">"rno-miR-143-3p"</span>, <span class="st">"rno-miR-27b-3p"</span>, <span class="st">"rno-miR-191a-5p"</span>, <span class="st">"rno-miR-122-5p"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># subset the database according to the miRNA of interest and the target score</span></span>
<span><span class="va">mir.targets.score90</span> <span class="op">=</span> <span class="va">mirdb.rat</span><span class="op">$</span><span class="va">ref2ens</span><span class="op">[</span><span class="va">mirdb.rat</span><span class="op">[</span>,<span class="st">"miRDB.ID"</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_10</span> <span class="op">&amp;</span> <span class="va">mirdb.rat</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">&gt;=</span> <span class="fl">90</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Remove any NA values</span></span>
<span><span class="va">mir.targets.score90</span> <span class="op">=</span> <span class="va">mir.targets.score90</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">mir.targets.score90</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># unlist the string list of names</span></span>
<span><span class="va">mir.targets.score90</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">mir.targets.score90</span>,</span>
<span>                                         <span class="fu">stringr</span><span class="fu">::</span><span class="va"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split</a></span>,</span>
<span>                                         <span class="st">", "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="ecdf-for-log2foldchange-of-mirna-targets-compared-to-genes-with-seed-matches">ECDF for log2(FoldChange) of miRNA targets compared to genes with
seed matches<a class="anchor" aria-label="anchor" href="#ecdf-for-log2foldchange-of-mirna-targets-compared-to-genes-with-seed-matches"></a>
</h2>
<p>In this analysis we will compare genes with a <code>mer7m8</code>
seed match to those that are targets of miRNA expression in the DESeq2
experiments. We will also have a third group that compares the shared
gene targets of the siRNA and miRNA.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set of genes that are specific to mer7m8 seed matches</span></span>
<span><span class="va">mer7m8.list</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">gene_id</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">mer7m8</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="op">!</span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">gene_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">mir.targets.score90</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Set of genes that are specific to seed and miRNA</span></span>
<span><span class="va">seed_and_mir</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">gene_id</span><span class="op">[</span><span class="va">res</span><span class="op">$</span><span class="va">mer7m8</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">res</span><span class="op">$</span><span class="va">gene_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">mir.targets.score90</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Set of genes that is specific to miRNA only</span></span>
<span><span class="va">mir.targets</span> <span class="op">=</span> <span class="va">mir.targets.score90</span><span class="op">[</span><span class="op">!</span><span class="va">mir.targets.score90</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">seed_and_mir</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Generate the background list of genes</span></span>
<span><span class="va">background.list</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">gene_id</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">gene_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">mer7m8.list</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">gene_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">mir.targets</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">gene_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">seed_and_mir</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span><span class="va">ecdf.results</span> <span class="op">=</span> <span class="fu">de_fc_ecdf</span><span class="op">(</span><span class="va">res</span>, </span>
<span>                             title <span class="op">=</span> <span class="st">"Ttr D1 30mkg"</span>,</span>
<span>                             <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Background"</span> <span class="op">=</span> <span class="va">background.list</span>, </span>
<span>                                  <span class="st">"mer7m8"</span> <span class="op">=</span> <span class="va">mer7m8.list</span>, </span>
<span>                                  <span class="st">"Top 10 miRNA"</span> <span class="op">=</span> <span class="va">mir.targets</span>, </span>
<span>                                  <span class="st">"Seed and miRNA"</span> <span class="op">=</span> <span class="va">seed_and_mir</span><span class="op">)</span>,</span>
<span>                             stats.test <span class="op">=</span> <span class="st">"KS"</span>, </span>
<span>                             factor.order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Background"</span>, </span>
<span>                                              <span class="st">"mer7m8"</span>, </span>
<span>                                              <span class="st">"Top 10 miRNA"</span>, </span>
<span>                                              <span class="st">"Seed and miRNA"</span><span class="op">)</span>, </span>
<span>                             null.name <span class="op">=</span> <span class="st">"Background"</span>,</span>
<span>                             target.name <span class="op">=</span> <span class="st">"Top 10 miRNA"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ecdf.results</span><span class="op">$</span><span class="va">plot</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tareian Cazares, Gulcin Ozer, Pradeep Varathan Pugalenthi, Jibo Wang, Rick Higgs.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
